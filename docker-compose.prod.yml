version: '3'
services:

  mongodb:
    image: mongo

  api:
    build: .
    command: bash -c "npm run build && npm run server"
    environment:
      - NODE_ENV=production
      - P4_AUTH_GOOGLE_KEY
      - P4_AUTH_GOOGLE_SECRET
      - P4_AUTH_GOOGLE_CALLBACK="http://it2810-22.idi.ntnu.no:8084"
      - P4_DB_HOST=mongodb
    volumes:
      - .:/srv/app
    ports:
      - "8084:8000"
